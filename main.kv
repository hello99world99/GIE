#:kivy 2.0.0
#:include components.kv
##:kivymd 0.104.2

<Body>:
    orientation: "vertical"
    MDToolbar:
        id: title
        title: "Groupement d'Interet Economique (GIE) Djiguiya".upper()
    MDToolbar:
        HeaderButton:
            text: f"[b]ENREGISTRER[/b]"
            on_press: root.showTitle()
            on_press: sm.current = "enregistrement"
        HeaderButton:
            text: "[b]PAIEMENT[/b]"
            on_press: root.hideTitle()
            on_press: sm.current = "paiement"
            on_press: idForPaiement.text = ""
            on_press: year.text = ""
        HeaderButton:
            text: "[b]EMPLOYEES[/b]"
            on_press: root.hideTitle()
            on_press: sm.current = "employees"
            on_press: searchId.text = "tous"
        HeaderButton:
            text: "[b]DETTE[/b]"
            on_press: root.showTitle()
            on_press: sm.current = "dette"
        HeaderButton:
            text: "[b]MISE EN JOUR[/b]"
            on_press: root.hideTitle()
            on_press: sm.current = "mise_en_jour"

    ScreenManager:
        id: sm
        MDScreen:
            name: "enregistrement"
            MDBoxLayout:
                orientation: "vertical"
                padding: 19
                InfosLabel:
                    text: "Veuillez entrer les informations neccéssaires."
                MDGridLayout:
                    cols: 2
                    EnregLabel:
                        text: "Prénom"
                    EnregInput:
                        id: enreg_firstName_input
                        hint_text: "Prénom"
                        #focus: True
                MDBoxLayout:
                    orientation: "vertical"
                    InfosLabel:
                        id: enreg_firstName_infos
                MDGridLayout:
                    cols: 2
                    EnregLabel:
                        text: "Surnom"
                    EnregInput:
                        id: enreg_surname_input
                        hint_text: "Surnom"
                MDBoxLayout:
                    orientation: "vertical"
                    InfosLabel:
                        id: enreg_surname_infos
                MDGridLayout:
                    cols: 2
                    EnregLabel:
                        text: "Nom"
                    EnregInput:
                        id: enreg_lastName_input
                        hint_text: "Nom"
                        on_text_validate: root.saveRecords()
                MDBoxLayout:
                    orientation: "vertical"
                    InfosLabel:
                        id: enreg_lastName_infos
                MDSeparator:
                    height: 5
                InfosLabel:
                    id: enreg_infos
                    text: "Status de l'enregistrement"
                MDBoxLayout:
                    orientation: 'horizontal'
                    spacing: '10dp'
                    Button:
                        text: "[size=19][b]Enregistrer[/b][/size]"
                        on_release: root.saveRecords()
                        markup: True
                        background_color: app.theme_cls.primary_color
                    Button:
                        text: "[size=19][b]Annuler[/b][/size]"
                        on_release: root.cancelEnregistrement()
                        markup: True
                        background_color: (1, 0, 0, 1)

        MDScreen:
            name: "paiement"
            MDBoxLayout:
                orientation: "vertical"
                MDToolbar:
                    id: pToolbar
                    title: "Entrer le numéro d'identifiant de la personne"
                    InputInToolbar:
                        id: idForPaiement
                        hint_text: "Identifiant..."
                        on_text: root.getUserInfosForPaiement(self.text)
                    InputInToolbar:
                        id: year
                        hint_text: "Annee..."
                        on_text: root.getUserInfosForPaiement(idForPaiement.text)
                    MenuButton:
                        id: addYear
                        text: str()
                        font_size: self.height-19
                MDBoxLayout:
                    orientation: "horizontal"
                    InfosLabel:
                        id: pFirstName
                        theme_text_color: "Custom"
                        text_color: (1, 1, 0, 1)
                    InfosLabel:
                        id: pSurname
                        theme_text_color: "Custom"
                        text_color: (1, 1, 0, 1)
                    InfosLabel:
                        id: pLastName
                        theme_text_color: "Custom"
                        text_color: (1, 1, 0, 1)
                MDBoxLayout:
                    orientation: "horizontal"
                    InfosLabel:
                        id: aaa
                        text: "Janvier"
                    InfosLabel:
                        id: aaa
                        text: "Février"
                    InfosLabel:
                        id: aaa
                        text: "Mars"
                    InfosLabel:
                        id: aaa
                        text: "Avril"
                MDBoxLayout:
                    orientation: "horizontal"
                    PaiementInput:
                        id: janvier
                        on_text: root.updatePaiement(idForPaiement.text, year.text, "JANVIER", self.text)
                        on_text: root.updateSomme(idForPaiement.text)
                    PaiementInput:
                        id: fevrier
                        on_text: root.updatePaiement(idForPaiement.text, year.text, "FEVRIER", self.text)
                        on_text: root.updateSomme(idForPaiement.text)
                    PaiementInput:
                        id: mars
                        on_text: root.updatePaiement(idForPaiement.text, year.text, "MARS", self.text)
                        on_text: root.updateSomme(idForPaiement.text)
                    PaiementInput:
                        id: avril
                        on_text: root.updatePaiement(idForPaiement.text, year.text, "AVRIL", self.text)
                        on_text: root.updateSomme(idForPaiement.text)
                MDBoxLayout:
                    orientation: "horizontal"
                    InfosLabel:
                        id: aaa
                        text: "Mai"
                    InfosLabel:
                        id: aaa
                        text: "Juin"
                    InfosLabel:
                        id: aaa
                        text: "Juillet"
                    InfosLabel:
                        id: aaa
                        text: "Aout"
                MDBoxLayout:
                    orientation: "horizontal"
                    PaiementInput:
                        id: mai
                        on_text: root.updatePaiement(idForPaiement.text, year.text, "MAI", self.text)
                        on_text: root.updateSomme(idForPaiement.text)
                    PaiementInput:
                        id: juin
                        on_text: root.updatePaiement(idForPaiement.text, year.text, "JUIN", self.text)
                        on_text: root.updateSomme(idForPaiement.text)
                    PaiementInput:
                        id: juillet
                        on_text: root.updatePaiement(idForPaiement.text, year.text, "JUILLET", self.text)
                        on_text: root.updateSomme(idForPaiement.text)
                    PaiementInput:
                        id: aout
                        on_text: root.updatePaiement(idForPaiement.text, year.text, "AOUT", self.text)
                        on_text: root.updateSomme(idForPaiement.text)
                MDBoxLayout:
                    orientation: "horizontal"
                    InfosLabel:
                        id: aaa
                        text: "Septembre"
                    InfosLabel:
                        id: aaa
                        text: "Octobre"
                    InfosLabel:
                        id: aaa
                        text: "Novembre"
                    InfosLabel:
                        id: aaa
                        text: "Décembre"
                MDBoxLayout:
                    orientation: "horizontal"
                    PaiementInput:
                        id: septembre
                        on_text: root.updatePaiement(idForPaiement.text, year.text, "SEPTEMBRE", self.text)
                        on_text: root.updateSomme(idForPaiement.text)
                    PaiementInput:
                        id: octobre
                        on_text: root.updatePaiement(idForPaiement.text, year.text, "OCTOBRE", self.text)
                        on_text: root.updateSomme(idForPaiement.text)
                    PaiementInput:
                        id: novembre
                        on_text: root.updatePaiement(idForPaiement.text, year.text, "NOVEMBRE", self.text)
                        on_text: root.updateSomme(idForPaiement.text)
                    PaiementInput:
                        id: decembre
                        on_text: root.updatePaiement(idForPaiement.text, year.text, "DECEMBRE", self.text)
                        on_text: root.updateSomme(idForPaiement.text)
                MDBoxLayout:
                    orientation: "horizontal"
                    InfosLabel:
                        id: paiementInfos
                    InfosLabel:
                        id: paiementDetteInfos
                    InfosLabel:
                        id: paiementCaisseInfos
                    
        MDScreen:
            name: "employees"
            MDBoxLayout:
                orientation: "vertical"
                MDToolbar:
                    title: "La liste des employées"
                    InputInToolbar:
                        id: searchId
                        text: "Filtre"
                        hint_text: "Entrer un nom..."
                        font_size: self.height-19
                        on_text: root.showEmployeesList(self.text)
                        markup: True
                UpdateGrid:
                    ScrollView:
                        do_scroll_x: False
                        do_scroll_y: True
                        adaptive_height: True
                        MDBoxLayout:
                            id: employees_list
                            orientation: "vertical"
                            adaptive_height: True
                MDBoxLayout:
                    orientation: "horizontal"
                    size_hint: (1, 0.1)
                    spacing: '10dp'
                    MDIconButton:
                        id: prv
                        icon: "arrow-left"
                        on_press: root.preview()
                        md_bg_color: app.theme_cls.primary_color

                    MDBoxLayout:
                        orientation: 'horizontal'
                        ScrollView:
                            do_scroll_x: True
                            do_scroll_y: False
                            adaptive_width: True
                            MDBoxLayout:
                                id: page_range
                                orientation: "horizontal"
                                adaptive_width: True

                    MDIconButton:
                        id: svt
                        icon: "arrow-right"
                        on_press: root.next()
                        md_bg_color: app.theme_cls.primary_color

        MDScreen:
            name: "dette"
            MDBoxLayout:
                orientation: "vertical"
                MDToolbar:
                    title: "Entrer le numéro d'identifiant de la personne"
                    InputInToolbar:
                        id: idForDette
                        on_text: root.getUserInfosForDette(self.text)
                MDBoxLayout:
                    orientation: "horizontal"
                    InfosLabel:
                        id: dFirstName
                        theme_text_color: "Custom"
                        font_size: 24
                        text_color: (1, 1, 0, 1)
                    InfosLabel:
                        id: dSurname
                        theme_text_color: "Custom"
                        font_size: 24
                        text_color: (1, 1, 0, 1)
                    InfosLabel:
                        id: dLastName
                        theme_text_color: "Custom"
                        font_size: 24
                        text_color: (1, 1, 0, 1)
                UpdateInput:
                    id: detteMontant
                    hint_text: "Montant"
                    size_hint: (0.75, 0.5)
                    pos_hint: {"center_x": 0.5, "center_y": 0.5}
                InfosLabel:
                    id: detteInfos
                    markup: True
                MDBoxLayout:
                    orientation: "horizontal"
                    padding: 24
                    spacing: '10dp'
                    Button:
                        text: "Accorder"
                        font_size: "24dp"
                        background_color: app.theme_cls.primary_color
                        on_press: root.setDette(idForDette.text)
                    Button:
                        text: "Annuler"
                        font_size: "24dp"
                        background_color: (1, 0, 0, 1)
                        on_press: root.clearDette()

        MDScreen:
            name: "mise_en_jour"
            MDBoxLayout:
                orientation: "vertical"
                size_hint: (1, 1)
                MDToolbar:
                    title: "Entrer le numéro d'identifiant de la personne"
                    InputInToolbar:
                        id: idToUpdate
                        on_text: root.getUserInfosForUpdate(self.text)
                UpdateGrid:
                    cols: 2
                    adaptive_height: True
                    size_hint: (1, 1)
                    UpdateInput:
                        id: updatePrenom
                        hint_text: "Prénom"
                    UpdateInput:
                        id: UpdateDateSortir
                        hint_text: "Date de sortir"
                UpdateGrid:
                    UpdateInput:
                        id: updateSurnom
                        hint_text: "Surnom"
                    UpdateInput:
                        id: updatePrenomTuteur
                        hint_text: "Prénom du tuteur"
                UpdateGrid:
                    UpdateInput:
                        id: updateNom
                        hint_text: "Nom"
                    UpdateInput:
                        id: updateNomTutuer
                        hint_text: "Nom du tuteur"
                UpdateGrid:
                    UpdateInput:
                        id: updateSalaire
                        hint_text: "Salaire"
                        icon_right: 'currency-eur'
                        icon_right_color: app.theme_cls.primary_color
                    UpdateInput:
                        id: updateTuteurContact
                        hint_text: "Contact du tuteur"
                        icon_right: 'phone'
                        icon_right_color: app.theme_cls.primary_color
                UpdateGrid:
                    UpdateInput:
                        id: updateDateEntrer
                        hint_text: "Date d'entrer"
                        icon_right: 'calendar'
                        icon_right_color: app.theme_cls.primary_color
                        on_focus: root.show_date_picker()
                    UpdateInput:
                        id: updateAdressTuteur
                        hint_text: "Adresse du tuteur"
                        icon_right: 'google-maps'
                        icon_right_color: app.theme_cls.primary_color
                MDBoxLayout:
                    orientation: "vertical"
                    InfosLabel:
                        id: updateInfos
                        size_hint: (1, None)
                        height: 0
                        padding: (0, 0)
                    MDBoxLayout:
                        orientation: 'horizontal'
                        size_hint: (1, 0.1)
                        padding: 9
                        spacing: '10dp'
                        Button:
                            text: "[b]Mettre à jour[/b]"
                            font_size: "19dp"
                            background_color: app.theme_cls.primary_color
                            on_press: root.setUpdate(idToUpdate.text)
                            markup: True
                        Button:
                            text: "[b]Annuler[/b]"
                            background_color: (1, 0, 0, 1)
                            font_size: "19dp"
                            on_press: root.clearUpdateID()
                            markup: True